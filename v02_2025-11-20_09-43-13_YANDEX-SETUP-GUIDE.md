# üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Yandex.Metrika API

## ‚úÖ –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ:

1. ‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram
2. ‚úÖ API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ Yandex.Metrika —Å–æ–∑–¥–∞–Ω
3. ‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç—á–µ—Ç–æ–≤ –≤ Telegram –≥–æ—Ç–æ–≤–∞

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å OAuth —Ç–æ–∫–µ–Ω

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://oauth.yandex.ru/
2. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω"
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
   - ‚úÖ `metrika:read` - —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö Metrika
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω

### –®–∞–≥ 2: –£–∑–Ω–∞—Ç—å ID —Å—á–µ—Ç—á–∏–∫–∞

1. –ó–∞–π–¥–∏—Ç–µ –≤ –≤–∞—à —Å—á–µ—Ç—á–∏–∫ Yandex.Metrika
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ URL: `https://metrika.yandex.ru/dashboard?id=12345678`
3. ID —Å—á–µ—Ç—á–∏–∫–∞ - —ç—Ç–æ —á–∏—Å–ª–æ –ø–æ—Å–ª–µ `id=`

–ò–ª–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å—á–µ—Ç—á–∏–∫–∞ ‚Üí "–û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "ID —Å—á–µ—Ç—á–∏–∫–∞"

### –®–∞–≥ 3: –î–æ–±–∞–≤–∏—Ç—å –≤ `.env.local`

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env.local` –∏ –¥–æ–±–∞–≤—å—Ç–µ:

```env
# Yandex.Metrika API
YANDEX_METRIKA_OAUTH_TOKEN=–≤–∞—à_oauth_—Ç–æ–∫–µ–Ω_–∑–¥–µ—Å—å
NEXT_PUBLIC_YM_ID=–≤–∞—à_id_—Å—á–µ—Ç—á–∏–∫–∞_–∑–¥–µ—Å—å
```

**–ü—Ä–∏–º–µ—Ä:**
```env
YANDEX_METRIKA_OAUTH_TOKEN=AQAAAAAxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
NEXT_PUBLIC_YM_ID=98765432
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://localhost:3000/api/analytics/yandex
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è JSON —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ Metrika.

### 2. –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–∞ –≤ Telegram

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```bash
npx tsx scripts/send-yandex-report.ts
```

–ò–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ POST –∑–∞–ø—Ä–æ—Å:
```bash
curl -X POST http://localhost:3000/api/analytics/yandex \
  -H "Content-Type: application/json" \
  -d '{"sendToTelegram": true}'
```

## üìä –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å:

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã):
- üë• **–í–∏–∑–∏—Ç—ã** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏–∑–∏—Ç–æ–≤
- üë§ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–∏  
- üìÑ **–ü—Ä–æ—Å–º–æ—Ç—Ä—ã** - –ø—Ä–æ—Å–º–æ—Ç—Ä—ã —Å—Ç—Ä–∞–Ω–∏—Ü
- ‚è± **–°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –≤—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ
- üìâ **–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–æ–≤** - –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–∫–∞–∑–æ–≤

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å):
- –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–π
- –ö–æ–Ω–≤–µ—Ä—Å–∏–∏
- –î–æ—Ö–æ–¥ –æ—Ç –ø–æ–∫—É–ø–æ–∫
- –ì–ª—É–±–∏–Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

### –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å):
- –ü–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º —Ç—Ä–∞—Ñ–∏–∫–∞
- –ü–æ —Å—Ç—Ä–∞–Ω–∞–º/–≥–æ—Ä–æ–¥–∞–º
- –ü–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
- –ü–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º
- –ü–æ –ø–æ–∏—Å–∫–æ–≤—ã–º –∑–∞–ø—Ä–æ—Å–∞–º

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—Ç–ø—Ä–∞–≤–∫—É –æ—Ç—á–µ—Ç–æ–≤:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç –≤ 9:00

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `vercel.json`:
```json
{
  "crons": [
    {
      "path": "/api/analytics/yandex",
      "schedule": "0 9 * * *"
    }
  ]
}
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Node.js cron (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `node-cron`:
```bash
npm install node-cron
```

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `scripts/cron-reports.ts` –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ.

## üì± –ü—Ä–∏–º–µ—Ä –æ—Ç—á–µ—Ç–∞ –≤ Telegram

```
üìä –û—Ç—á–µ—Ç Yandex.Metrika

üìÖ –ü–µ—Ä–∏–æ–¥: 20.11.2025 - 21.11.2025

üìà –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
üë• –í–∏–∑–∏—Ç—ã: 1,234
üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: 987
üìÑ –ü—Ä–æ—Å–º–æ—Ç—Ä—ã: 3,456
‚è± –°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 2 –º–∏–Ω 15 —Å–µ–∫
üìâ –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–æ–≤: 45.2%

üîó –û—Ç–∫—Ä—ã—Ç—å –≤ Metrika
```

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ:

1. ‚úÖ –ü–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Yandex.Metrika —á–µ—Ä–µ–∑ API
2. ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç—á–µ—Ç—ã –≤ Telegram –ø–æ –∑–∞–ø—Ä–æ—Å—É
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
4. ‚úÖ –ü–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º —Ç—Ä–∞—Ñ–∏–∫–∞, –≥–æ—Ä–æ–¥–∞–º, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
5. ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–π –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

## üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–º–æ—Ç—Ä–∏—Ç–µ —Ñ–∞–π–ª `v02_2025-11-20_09-43-13_YANDEX-METRIKA-INTEGRATION.md` –¥–ª—è –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ API.

---

**–ì–æ—Ç–æ–≤–æ!** –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è OAuth —Ç–æ–∫–µ–Ω–∞ –∏ ID —Å—á–µ—Ç—á–∏–∫–∞ –≤ `.env.local`, —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—á–Ω–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å! üöÄ

